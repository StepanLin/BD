# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–µ —Ä–∞–±–æ—Ç—ã –ø–æ –±–∞–∑–∞–º –¥–∞–Ω–Ω—ã—Ö

## –°—Ç—É–¥–µ–Ω—Ç
**–õ–∏–Ω–µ–µ–≤–∏—á –°—Ç–µ–ø–∞–Ω** (—Å—Ö–µ–º–∞ `Lineycev_Stepan_2272`)

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞


## –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–µ —Ä–∞–±–æ—Ç—ã

Lineycev_Stepan_2272/
‚îú‚îÄ‚îÄ –¢–∞–±–ª–∏—Ü—ã (8 —à—Ç.)
‚îú‚îÄ‚îÄ –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è (Views)
‚îú‚îÄ‚îÄ –§—É–Ω–∫—Ü–∏–∏ (Functions)
‚îú‚îÄ‚îÄ –¢—Ä–∏–≥–≥–µ—Ä—ã (Triggers)
‚îî‚îÄ‚îÄ –ò–Ω–¥–µ–∫—Å—ã (Indexes)

### üìã –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è 1-2: –°–æ–∑–¥–∞–Ω–∏–µ –ë–î "CarShowroom"
**–¶–µ–ª—å:** –°–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—É—é –ë–î –∞–≤—Ç–æ—Å–∞–ª–æ–Ω–∞.

#### –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã:
1. **Brands** - –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π
2. **CarModels** - –º–æ–¥–µ–ª–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π
3. **Showroom** - –∞–≤—Ç–æ—Å–∞–ª–æ–Ω—ã
4. **Cars** - –∞–≤—Ç–æ–º–æ–±–∏–ª–∏ –≤ –Ω–∞–ª–∏—á–∏–∏
5. **Employees** - —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏
6. **Customers** - –∫–ª–∏–µ–Ω—Ç—ã
7. **Sales** - –ø—Ä–æ–¥–∞–∂–∏
8. **TestDrives** - —Ç–µ—Å—Ç-–¥—Ä–∞–π–≤—ã

#### –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ —Å JOIN:
```sql
SELECT s.sale_date, c.first_name, b.brand_name, cm.model_name
FROM Sales s
JOIN Customers c ON s.CustomerID = c.CustomerID
JOIN Cars car ON s.CarID = car.CarID
JOIN CarModels cm ON car.ModelID = cm.ModelID
JOIN Brands b ON cm.BrandID = b.BrandID; 
```
 –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è 3: –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∏ —Ñ—É–Ω–∫—Ü–∏–∏
–¶–µ–ª—å: –°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏.

–°–æ–∑–¥–∞–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã:
–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ Sales_Report - —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º

–§—É–Ω–∫—Ü–∏—è Get_Sales_Report() - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞ –ø–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏:
```sql
-- –í—Å–µ –ø—Ä–æ–¥–∞–∂–∏
SELECT * FROM Get_Sales_Report();

-- –ü—Ä–æ–¥–∞–∂–∏ Toyota –∑–∞ –º–∞—Ä—Ç 2024
SELECT * FROM Get_Sales_Report(
    p_start_date => '2024-03-01',
    p_end_date => '2024-03-31',
    p_brand_name => 'Toyota'
);
```
‚ö° –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è 4: –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
–¶–µ–ª—å: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ –∏–Ω–¥–µ–∫—Å—ã –∏ –∞–Ω–∞–ª–∏–∑ –ø–ª–∞–Ω–æ–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö:
–°–æ–∑–¥–∞–Ω–æ 20 000+ –∑–∞–ø–∏—Å–µ–π –≤ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö

–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ª—É—á–∞–π–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

–°–æ–∑–¥–∞–Ω–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã:

```sql
CREATE INDEX idx_sales_saledate ON Sales(sale_date);
CREATE INDEX idx_sales_customerid ON Sales(customerid);
CREATE INDEX idx_cars_modelid ON Cars(modelid);
-- –∏ –¥—Ä—É–≥–∏–µ...
```

<img width="867" height="265" alt="image" src="https://github.com/user-attachments/assets/ea3f447c-2759-4c44-9e62-4087a0f0d56c" />

–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è 5: –¢—Ä–∏–≥–≥–µ—Ä—ã
–¶–µ–ª—å: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∏ —Å–∏—Å—Ç–µ–º—É –∞—É–¥–∏—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π.

–°–æ–∑–¥–∞–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã:
–¢–∞–±–ª–∏—Ü–∞ Change_Log - –∂—É—Ä–Ω–∞–ª –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π

–¢—Ä–∏–≥–≥–µ—Ä trigger_log_sales_changes - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∂—É—Ä–Ω–∞–ª–∏—Ä–æ–≤–∞–Ω–∏–µ

–¢—Ä–∏–≥–≥–µ—Ä trigger_cascade_delete_brand - –∫–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ

–ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤:

-- –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –±—Ä–µ–Ω–¥–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è –≤—Å–µ –µ–≥–æ –º–æ–¥–µ–ª–∏
DELETE FROM Brands WHERE BrandID = 1;

-- –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ç–∞–±–ª–∏—Ü–µ Sales —Ñ–∏–∫—Å–∏—Ä—É—é—Ç—Å—è –≤ Change_Log
INSERT INTO Sales (...) VALUES (...);

–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫
–°–£–ë–î: PostgreSQL 15+

–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å: pgAdmin 4

–Ø–∑—ã–∫: SQL, PL/pgSQL

–ö–∞–∫ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –ø—Ä–æ–µ–∫—Ç
–°–æ–∑–¥–∞—Ç—å —Å—Ö–µ–º—É –≤ PostgreSQL:

